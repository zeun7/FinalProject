<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="multi.com.finalproject">
	
	<select id="MNG_FRIENDS"
		resultType="multi.com.finalproject.manage.model.ManageFriendsVO">
		select grade, nickname2 from friends where nickname = #{nickname} and grade != 3
	</select>
	
	<select id="MNG_SEARCH_LIST_NICKNAME"
		resultType="multi.com.finalproject.member.model.MemberVO">
		select nickname from member where nickname like #{searchWord} 
		minus select nickname2 from friends where nickname = #{nickname} 
		minus select nickname from member where nickname = #{nickname}
	</select>
	
	<insert id="MNG_ADD_FRIEND">
		insert into friends(fnum, nickname, nickname2)
		values(seq_friends.nextval, #{nickname1}, #{nickname2})
	</insert>
	
	<delete id="MNG_DEL_FRIEND">
		delete from friends where nickname = #{nickname1} and nickname2 = #{nickname2}
	</delete>
	
	<select id="MNG_M_SELECT_BAN" resultType="multi.com.finalproject.manage.model.ManageFriendsVO">
		select * from friends where nickname = #{nickname} and grade = 3
	</select>
	
	<update id="MNG_M_ADD_BAN">
		update friends set grade = 3 where nickname = #{nickname1} and nickname2 = #{nickname2}
	</update>
	
	<delete id="MNG_M_DEL_BAN">
		delete from friends where nickname = #{nickname1} and nickname2 = #{nickname2} and grade = 3
	</delete>
	
	<select id="MNG_B_SELECT_REPORT" resultType="multi.com.finalproject.manage.model.ManageReportVO">
		select r.bnum, b.title, b.writer, r.reason from board b, report r where b.bnum=r.bnum
	</select>
	
	<select id="MNG_C_SELECT_REPORT" resultType="multi.com.finalproject.manage.model.ManageReportVO">
		select r.cnum, c.content, c.writer, r.reason from comments c, report r where c.cnum=r.cnum
	</select>
	
	<select id="MNG_MB_SELECT_REPORT" resultType="multi.com.finalproject.manage.model.ManageReportVO">
		select r.mbnum, mb.title, mb.writer, r.reason from miniboard mb, report r where mb.mbnum=r.mbnum
	</select>
	
	<select id="MNG_MC_SELECT_REPORT" resultType="multi.com.finalproject.manage.model.ManageReportVO">
		select r.cnum, mc.content, mc.writer, r.reason from minicomments mc, report r where mc.mcnum=r.mcnum
	</select>
</mapper>